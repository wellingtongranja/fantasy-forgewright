<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Command Bar v2 Test</title>
    <link rel="stylesheet" href="/src/components/command-bar-v2/styles/command-bar.css">
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 {
            margin: 0 0 20px;
            color: #1a202c;
        }
        
        .instructions {
            color: #4a5568;
            line-height: 1.6;
            margin-bottom: 30px;
        }
        
        .trigger-button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .trigger-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);
        }
        
        .trigger-button:active {
            transform: translateY(0);
        }
        
        .status {
            margin-top: 30px;
            padding: 15px;
            background: #f7fafc;
            border-radius: 6px;
            border-left: 4px solid #667eea;
        }
        
        .status h3 {
            margin: 0 0 10px;
            color: #2d3748;
        }
        
        #log {
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 14px;
            color: #4a5568;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .log-entry {
            padding: 4px 0;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .log-entry:last-child {
            border-bottom: none;
        }
        
        .shortcuts {
            margin-top: 20px;
            padding: 15px;
            background: #edf2f7;
            border-radius: 6px;
        }
        
        kbd {
            background: white;
            padding: 2px 6px;
            border-radius: 4px;
            border: 1px solid #cbd5e0;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 13px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸŽ¯ Command Bar v2 Test Page</h1>
        
        <div class="instructions">
            <p>This is a test page for the new modular Command Bar v2 component.</p>
            <p>Click the button below or press <kbd>Ctrl</kbd> + <kbd>Space</kbd> to open the command palette.</p>
        </div>
        
        <button class="trigger-button" id="openCommandBar">
            Open Command Bar
        </button>
        
        <div class="shortcuts">
            <strong>Keyboard Shortcuts:</strong>
            <ul>
                <li><kbd>Ctrl</kbd> + <kbd>Space</kbd> - Open command bar</li>
                <li><kbd>â†‘</kbd> <kbd>â†“</kbd> - Navigate through commands</li>
                <li><kbd>Enter</kbd> - Execute selected command</li>
                <li><kbd>Esc</kbd> - Close command bar</li>
            </ul>
        </div>
        
        <div class="status">
            <h3>Event Log:</h3>
            <div id="log"></div>
        </div>
    </div>

    <script type="module">
        import { CommandBar } from '/src/components/command-bar-v2/components/CommandBar.js'
        
        // Sample commands for testing
        const sampleCommands = [
            {
                name: 'New Document',
                description: 'Create a new document',
                category: 'Documents',
                aliases: [':n', 'new'],
                parameters: [
                    { name: 'title', required: false, type: 'string', description: 'Document title' }
                ],
                handler: (query) => log('Execute: New Document')
            },
            {
                name: 'Save Document',
                description: 'Save the current document',
                category: 'Documents',
                aliases: [':s', 'save'],
                parameters: [
                    { name: 'filename', required: false, type: 'string', description: 'Save as filename' }
                ],
                handler: () => log('Execute: Save Document')
            },
            {
                name: 'Open Document',
                description: 'Open an existing document',
                category: 'Documents',
                aliases: [':o', 'open'],
                parameters: [
                    { name: 'filename', required: true, type: 'string', description: 'Document to open' }
                ],
                handler: () => log('Execute: Open Document')
            },
            {
                name: 'Search',
                description: 'Search within documents',
                category: 'Documents',
                aliases: [':f', 'find', 'search'],
                parameters: [
                    { name: 'query', required: true, type: 'string', description: 'Search query' }
                ],
                handler: (query) => log(`Execute: Search for "${query}"`)
            },
            {
                name: 'Export',
                description: 'Export document to various formats',
                category: 'Documents',
                aliases: [':ex', 'export'],
                parameters: [
                    { name: 'format', required: true, type: 'string', description: 'Export format (md, html, pdf, txt)' }
                ],
                handler: () => log('Execute: Export')
            },
            {
                name: 'Width',
                description: 'Set editor width',
                category: 'Editor',
                aliases: [':65', ':80', ':90', 'width'],
                parameters: [
                    { name: 'chars', required: false, type: 'number', description: 'Character width (65, 80, 90)' }
                ],
                handler: () => log('Execute: Set Width')
            },
            {
                name: 'Toggle Theme',
                description: 'Switch between light and dark theme',
                category: 'Editor',
                aliases: [':tt', 'theme'],
                handler: () => log('Execute: Toggle Theme')
            },
            {
                name: 'GitHub Config',
                description: 'Configure GitHub repository',
                category: 'GitHub',
                aliases: [':gcf', 'github config'],
                parameters: [
                    { name: 'owner', required: true, type: 'string', description: 'Repository owner' },
                    { name: 'repo', required: true, type: 'string', description: 'Repository name' }
                ],
                handler: () => log('Execute: GitHub Config')
            },
            {
                name: 'GitHub Status',
                description: 'Check GitHub sync status',
                category: 'GitHub',
                aliases: [':gst', 'git status'],
                handler: () => log('Execute: GitHub Status')
            },
            {
                name: 'GitHub Push',
                description: 'Push changes to GitHub',
                category: 'GitHub',
                aliases: [':gpu', 'git push'],
                handler: () => log('Execute: GitHub Push')
            },
            {
                name: 'Settings',
                description: 'Open application settings',
                category: 'System',
                aliases: [':se', 'settings', 'preferences'],
                handler: () => log('Execute: Settings')
            },
            {
                name: 'Help',
                description: 'Show help and documentation',
                category: 'System',
                aliases: [':h', 'help', 'docs'],
                parameters: [
                    { name: 'topic', required: false, type: 'string', description: 'Help topic' }
                ],
                handler: () => log('Execute: Help')
            }
        ]
        
        // Logging function
        const logContainer = document.getElementById('log')
        let logCount = 0
        
        function log(message) {
            const entry = document.createElement('div')
            entry.className = 'log-entry'
            const time = new Date().toLocaleTimeString()
            entry.textContent = `[${time}] ${message}`
            logContainer.appendChild(entry)
            logContainer.scrollTop = logContainer.scrollHeight
            
            // Keep only last 10 entries
            if (++logCount > 10) {
                logContainer.firstChild.remove()
            }
        }
        
        // Initialize command bar
        log('Initializing Command Bar v2...')
        
        const commandBar = new CommandBar({
            container: document.body,
            commands: sampleCommands,
            options: {
                placeholder: 'Type a command or search...',
                position: 'top',
                maxResults: 10
            }
        })
        
        // Initialize the component
        await commandBar.initialize()
        log('Command Bar v2 initialized successfully')
        
        // Subscribe to events
        commandBar.on('command:execute', (event) => {
            const { command, query } = event.data
            log(`Command executed: ${command.name}`)
        })
        
        commandBar.on('show', () => {
            log('Command bar opened')
        })
        
        commandBar.on('hide', () => {
            log('Command bar closed')
        })
        
        // Button trigger
        document.getElementById('openCommandBar').addEventListener('click', () => {
            commandBar.show()
        })
        
        // Keyboard shortcut
        document.addEventListener('keydown', (e) => {
            if ((e.ctrlKey || e.metaKey) && e.code === 'Space') {
                e.preventDefault()
                commandBar.toggle()
            }
        })
        
        log('Ready! Press Ctrl+Space or click the button to open')
    </script>
</body>
</html>